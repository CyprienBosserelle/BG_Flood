\hypertarget{Reimann_8cu}{}\doxysection{src/\+Reimann.cu File Reference}
\label{Reimann_8cu}\index{src/Reimann.cu@{src/Reimann.cu}}
{\ttfamily \#include \char`\"{}Reimann.\+h\char`\"{}}\newline
Include dependency graph for Reimann.\+cu\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class T $>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a9ce1a53480cb4a15991ac592d23e511c}{Update\+Buttinger\+XGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$ XFlux, T $\ast$dtmax, T $\ast$zb)
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. GPU version for t X-\/axis \end{DoxyCompactList}\item 
template \+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_aba39035ab94ce1f6b2bb685b2cee7075}{Update\+Buttinger\+XGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$ XFlux, float $\ast$dtmax, float $\ast$zb)
\item 
template \+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_ac73231851279bd3d155883eb7ff2844f}{Update\+Buttinger\+XGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$ XFlux, double $\ast$dtmax, double $\ast$zb)
\item 
{\footnotesize template$<$class T $>$ }\\\+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_ab0fa85625226336dc414db1394989a79}{Update\+Buttinger\+XCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$ XFlux, T $\ast$dtmax, T $\ast$zb)
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. CPU version for the X-\/axis \end{DoxyCompactList}\item 
template \+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a557bfaf45e132125428a1d417d6ad8d2}{Update\+Buttinger\+XCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$ XFlux, float $\ast$dtmax, float $\ast$zb)
\item 
template \+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a76c7ff126a9bb767505ac4861b6d7ba2}{Update\+Buttinger\+XCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$ XFlux, double $\ast$dtmax, double $\ast$zb)
\item 
{\footnotesize template$<$class T $>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a1d507adfb58f284de7e7e4ad10065d81}{Update\+Buttinger\+YGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$ XFlux, T $\ast$dtmax, T $\ast$zb)
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. GPU version for the Y-\/axis \end{DoxyCompactList}\item 
template \+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a23ef71c5314a763d3f10e4062b268c7b}{Update\+Buttinger\+YGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$ XFlux, float $\ast$dtmax, float $\ast$zb)
\item 
template \+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a34b2d1e844292cace3b72df9297ae3c9}{Update\+Buttinger\+YGPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$ XFlux, double $\ast$dtmax, double $\ast$zb)
\item 
{\footnotesize template$<$class T $>$ }\\\+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a1779e93ac094399d0c1a6dbfdc75ca7a}{Update\+Buttinger\+YCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$ XFlux, T $\ast$dtmax, T $\ast$zb)
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. CPU version for the Y-\/axis \end{DoxyCompactList}\item 
template \+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a9dbc4ca11f4e8fd5417cb5e05fe4e3f5}{Update\+Buttinger\+YCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$ XFlux, float $\ast$dtmax, float $\ast$zb)
\item 
template \+\_\+\+\_\+host\+\_\+\+\_\+ void \mbox{\hyperlink{Reimann_8cu_a5acda7e5802c7b23fbb709afcf42e66c}{Update\+Buttinger\+YCPU}} (\mbox{\hyperlink{classParam}{Param}} XParam, \mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$ XBlock, \mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$ XEv, \mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$ XGrad, \mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$ XFlux, double $\ast$dtmax, double $\ast$zb)
\item 
{\footnotesize template$<$class T $>$ }\\\+\_\+\+\_\+host\+\_\+\+\_\+ \+\_\+\+\_\+device\+\_\+\+\_\+ T \mbox{\hyperlink{Reimann_8cu_a183a9bf3de84eaabd380c7a15243e4e3}{hllc}} (T g, T delta, T epsi, T CFL, T cm, T fm, T hm, T hp, T um, T up, T \&fh, T \&fq)
\begin{DoxyCompactList}\small\item\em Calculate the Harten-\/\+Lax-\/van Leer-\/contact (HLLC) flux. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{Reimann_8cu_a183a9bf3de84eaabd380c7a15243e4e3}\label{Reimann_8cu_a183a9bf3de84eaabd380c7a15243e4e3}} 
\index{Reimann.cu@{Reimann.cu}!hllc@{hllc}}
\index{hllc@{hllc}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{hllc()}{hllc()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
T hllc (\begin{DoxyParamCaption}\item[{T}]{g,  }\item[{T}]{delta,  }\item[{T}]{epsi,  }\item[{T}]{CFL,  }\item[{T}]{cm,  }\item[{T}]{fm,  }\item[{T}]{hm,  }\item[{T}]{hp,  }\item[{T}]{um,  }\item[{T}]{up,  }\item[{T \&}]{fh,  }\item[{T \&}]{fq }\end{DoxyParamCaption})}



Calculate the Harten-\/\+Lax-\/van Leer-\/contact (HLLC) flux. 

\hypertarget{Reimann_8h_autotoc_md179}{}\doxysubsubsection{Description}\label{Reimann_8h_autotoc_md179}
This an implementation of the HLLC solver.\hypertarget{Reimann_8h_autotoc_md180}{}\doxysubsubsection{Where does this come from\+:}\label{Reimann_8h_autotoc_md180}
This scheme was adapted/modified from the Basilisk source code. \href{http://basilisk.fr/src/riemann.h}{\texttt{ http\+://basilisk.\+fr/src/riemann.\+h}}

Reference\+: (Basilisk reference the scheme from Kurganov reference below) Kurganov, A., \& Levy, D. (2002). Central-\/upwind schemes for the Saint-\/\+Venant system. Mathematical Modelling and Numerical Analysis, 36(3), 397-\/425. \mbox{\Hypertarget{Reimann_8cu_a76c7ff126a9bb767505ac4861b6d7ba2}\label{Reimann_8cu_a76c7ff126a9bb767505ac4861b6d7ba2}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXCPU@{UpdateButtingerXCPU}}
\index{UpdateButtingerXCPU@{UpdateButtingerXCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXCPU()}{UpdateButtingerXCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+host\+\_\+\+\_\+ void Update\+Buttinger\+XCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$}]{XFlux,  }\item[{double $\ast$}]{dtmax,  }\item[{double $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a557bfaf45e132125428a1d417d6ad8d2}\label{Reimann_8cu_a557bfaf45e132125428a1d417d6ad8d2}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXCPU@{UpdateButtingerXCPU}}
\index{UpdateButtingerXCPU@{UpdateButtingerXCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXCPU()}{UpdateButtingerXCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+host\+\_\+\+\_\+ void Update\+Buttinger\+XCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$}]{XFlux,  }\item[{float $\ast$}]{dtmax,  }\item[{float $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_ab0fa85625226336dc414db1394989a79}\label{Reimann_8cu_ab0fa85625226336dc414db1394989a79}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXCPU@{UpdateButtingerXCPU}}
\index{UpdateButtingerXCPU@{UpdateButtingerXCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXCPU()}{UpdateButtingerXCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void Update\+Buttinger\+XCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$}]{XFlux,  }\item[{T $\ast$}]{dtmax,  }\item[{T $\ast$}]{zb }\end{DoxyParamCaption})}



\char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. CPU version for the X-\/axis 

\hypertarget{Reimann_8h_autotoc_md173}{}\doxysubsubsection{Description}\label{Reimann_8h_autotoc_md173}
This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-\/balanced meaning that it conserve the \char`\"{}lake-\/at-\/rest\char`\"{} states.

For optimising the code on CPU and GPU there are 4 versions of this function\+: X or Y and CPU or GPU\hypertarget{Reimann_8h_autotoc_md174}{}\doxysubsubsection{Where does this come from\+:}\label{Reimann_8h_autotoc_md174}
This scheme was adapted/modified from the Basilisk / B-\/\+Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction \href{http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h}{\texttt{ http\+://basilisk.\+fr/sandbox/b-\/flood/saint-\/venant-\/topo.\+h}}

Reference\+: Kirstetter, G., Delestre, O., Lagree, P.-\/Y., Popinet, S., and Josserand, C.\+: B-\/flood 1.\+0\+: an open-\/source Saint-\/\+Venant model for flash flood simulation using adaptive refinement, Geosci. \mbox{\hyperlink{structModel}{Model}} Dev. Discuss. \mbox{[}preprint\mbox{]}, \href{https://doi.org/10.5194/gmd-2021-15}{\texttt{ https\+://doi.\+org/10.\+5194/gmd-\/2021-\/15}}, in review, 2021.$\ast$ Buttinger-\/\+Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.\+: A fast second-\/order shallow water scheme on two-\/dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-\/108, 2019. \mbox{\Hypertarget{Reimann_8cu_ac73231851279bd3d155883eb7ff2844f}\label{Reimann_8cu_ac73231851279bd3d155883eb7ff2844f}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXGPU@{UpdateButtingerXGPU}}
\index{UpdateButtingerXGPU@{UpdateButtingerXGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXGPU()}{UpdateButtingerXGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+global\+\_\+\+\_\+ void Update\+Buttinger\+XGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$}]{XFlux,  }\item[{double $\ast$}]{dtmax,  }\item[{double $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_aba39035ab94ce1f6b2bb685b2cee7075}\label{Reimann_8cu_aba39035ab94ce1f6b2bb685b2cee7075}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXGPU@{UpdateButtingerXGPU}}
\index{UpdateButtingerXGPU@{UpdateButtingerXGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXGPU()}{UpdateButtingerXGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+global\+\_\+\+\_\+ void Update\+Buttinger\+XGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$}]{XFlux,  }\item[{float $\ast$}]{dtmax,  }\item[{float $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a9ce1a53480cb4a15991ac592d23e511c}\label{Reimann_8cu_a9ce1a53480cb4a15991ac592d23e511c}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerXGPU@{UpdateButtingerXGPU}}
\index{UpdateButtingerXGPU@{UpdateButtingerXGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerXGPU()}{UpdateButtingerXGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void Update\+Buttinger\+XGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$}]{XFlux,  }\item[{T $\ast$}]{dtmax,  }\item[{T $\ast$}]{zb }\end{DoxyParamCaption})}



\char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. GPU version for t X-\/axis 

\hypertarget{Reimann_8h_autotoc_md171}{}\doxysubsubsection{Description}\label{Reimann_8h_autotoc_md171}
This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-\/balanced meaning that it conserve the \char`\"{}lake-\/at-\/rest\char`\"{} states.

For optimising the code on CPU and GPU there are 4 versions of this function\+: X or Y and CPU or GPU\hypertarget{Reimann_8h_autotoc_md172}{}\doxysubsubsection{Where does this come from\+:}\label{Reimann_8h_autotoc_md172}
This scheme was adapted/modified from the Basilisk / B-\/\+Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction \href{http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h}{\texttt{ http\+://basilisk.\+fr/sandbox/b-\/flood/saint-\/venant-\/topo.\+h}}

Reference\+: Kirstetter, G., Delestre, O., Lagree, P.-\/Y., Popinet, S., and Josserand, C.\+: B-\/flood 1.\+0\+: an open-\/source Saint-\/\+Venant model for flash flood simulation using adaptive refinement, Geosci. \mbox{\hyperlink{structModel}{Model}} Dev. Discuss. \mbox{[}preprint\mbox{]}, \href{https://doi.org/10.5194/gmd-2021-15}{\texttt{ https\+://doi.\+org/10.\+5194/gmd-\/2021-\/15}}, in review, 2021.$\ast$ Buttinger-\/\+Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.\+: A fast second-\/order shallow water scheme on two-\/dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-\/108, 2019. \mbox{\Hypertarget{Reimann_8cu_a5acda7e5802c7b23fbb709afcf42e66c}\label{Reimann_8cu_a5acda7e5802c7b23fbb709afcf42e66c}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYCPU@{UpdateButtingerYCPU}}
\index{UpdateButtingerYCPU@{UpdateButtingerYCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYCPU()}{UpdateButtingerYCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+host\+\_\+\+\_\+ void Update\+Buttinger\+YCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$}]{XFlux,  }\item[{double $\ast$}]{dtmax,  }\item[{double $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a9dbc4ca11f4e8fd5417cb5e05fe4e3f5}\label{Reimann_8cu_a9dbc4ca11f4e8fd5417cb5e05fe4e3f5}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYCPU@{UpdateButtingerYCPU}}
\index{UpdateButtingerYCPU@{UpdateButtingerYCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYCPU()}{UpdateButtingerYCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+host\+\_\+\+\_\+ void Update\+Buttinger\+YCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$}]{XFlux,  }\item[{float $\ast$}]{dtmax,  }\item[{float $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a1779e93ac094399d0c1a6dbfdc75ca7a}\label{Reimann_8cu_a1779e93ac094399d0c1a6dbfdc75ca7a}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYCPU@{UpdateButtingerYCPU}}
\index{UpdateButtingerYCPU@{UpdateButtingerYCPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYCPU()}{UpdateButtingerYCPU()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void Update\+Buttinger\+YCPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$}]{XFlux,  }\item[{T $\ast$}]{dtmax,  }\item[{T $\ast$}]{zb }\end{DoxyParamCaption})}



\char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. CPU version for the Y-\/axis 

\hypertarget{Reimann_8h_autotoc_md177}{}\doxysubsubsection{Description}\label{Reimann_8h_autotoc_md177}
This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-\/balanced meaning that it conserve the \char`\"{}lake-\/at-\/rest\char`\"{} states.

For optimising the code on CPU and GPU there are 4 versions of this function\+: X or Y and CPU or GPU\hypertarget{Reimann_8h_autotoc_md178}{}\doxysubsubsection{Where does this come from\+:}\label{Reimann_8h_autotoc_md178}
This scheme was adapted/modified from the Basilisk / B-\/\+Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction \href{http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h}{\texttt{ http\+://basilisk.\+fr/sandbox/b-\/flood/saint-\/venant-\/topo.\+h}}

Reference\+: Kirstetter, G., Delestre, O., Lagree, P.-\/Y., Popinet, S., and Josserand, C.\+: B-\/flood 1.\+0\+: an open-\/source Saint-\/\+Venant model for flash flood simulation using adaptive refinement, Geosci. \mbox{\hyperlink{structModel}{Model}} Dev. Discuss. \mbox{[}preprint\mbox{]}, \href{https://doi.org/10.5194/gmd-2021-15}{\texttt{ https\+://doi.\+org/10.\+5194/gmd-\/2021-\/15}}, in review, 2021.$\ast$ Buttinger-\/\+Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.\+: A fast second-\/order shallow water scheme on two-\/dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-\/108, 2019. \mbox{\Hypertarget{Reimann_8cu_a34b2d1e844292cace3b72df9297ae3c9}\label{Reimann_8cu_a34b2d1e844292cace3b72df9297ae3c9}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYGPU@{UpdateButtingerYGPU}}
\index{UpdateButtingerYGPU@{UpdateButtingerYGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYGPU()}{UpdateButtingerYGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+global\+\_\+\+\_\+ void Update\+Buttinger\+YGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ double $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ double $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ double $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ double $>$}]{XFlux,  }\item[{double $\ast$}]{dtmax,  }\item[{double $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a23ef71c5314a763d3f10e4062b268c7b}\label{Reimann_8cu_a23ef71c5314a763d3f10e4062b268c7b}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYGPU@{UpdateButtingerYGPU}}
\index{UpdateButtingerYGPU@{UpdateButtingerYGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYGPU()}{UpdateButtingerYGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template \+\_\+\+\_\+global\+\_\+\+\_\+ void Update\+Buttinger\+YGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ float $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ float $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ float $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ float $>$}]{XFlux,  }\item[{float $\ast$}]{dtmax,  }\item[{float $\ast$}]{zb }\end{DoxyParamCaption})}

\mbox{\Hypertarget{Reimann_8cu_a1d507adfb58f284de7e7e4ad10065d81}\label{Reimann_8cu_a1d507adfb58f284de7e7e4ad10065d81}} 
\index{Reimann.cu@{Reimann.cu}!UpdateButtingerYGPU@{UpdateButtingerYGPU}}
\index{UpdateButtingerYGPU@{UpdateButtingerYGPU}!Reimann.cu@{Reimann.cu}}
\doxysubsubsection{\texorpdfstring{UpdateButtingerYGPU()}{UpdateButtingerYGPU()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void Update\+Buttinger\+YGPU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classParam}{Param}}}]{XParam,  }\item[{\mbox{\hyperlink{structBlockP}{BlockP}}$<$ T $>$}]{XBlock,  }\item[{\mbox{\hyperlink{structEvolvingP}{EvolvingP}}$<$ T $>$}]{XEv,  }\item[{\mbox{\hyperlink{structGradientsP}{GradientsP}}$<$ T $>$}]{XGrad,  }\item[{\mbox{\hyperlink{structFluxP}{FluxP}}$<$ T $>$}]{XFlux,  }\item[{T $\ast$}]{dtmax,  }\item[{T $\ast$}]{zb }\end{DoxyParamCaption})}



\char`\"{}\+Adaptive\char`\"{} second-\/order hydrostatic reconstruction. GPU version for the Y-\/axis 

\hypertarget{Reimann_8h_autotoc_md175}{}\doxysubsubsection{Description}\label{Reimann_8h_autotoc_md175}
This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-\/balanced meaning that it conserve the \char`\"{}lake-\/at-\/rest\char`\"{} states.

For optimising the code on CPU and GPU there are 4 versions of this function\+: X or Y and CPU or GPU\hypertarget{Reimann_8h_autotoc_md176}{}\doxysubsubsection{Where does this come from\+:}\label{Reimann_8h_autotoc_md176}
This scheme was adapted/modified from the Basilisk / B-\/\+Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction \href{http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h}{\texttt{ http\+://basilisk.\+fr/sandbox/b-\/flood/saint-\/venant-\/topo.\+h}}

Reference\+: Kirstetter, G., Delestre, O., Lagree, P.-\/Y., Popinet, S., and Josserand, C.\+: B-\/flood 1.\+0\+: an open-\/source Saint-\/\+Venant model for flash flood simulation using adaptive refinement, Geosci. \mbox{\hyperlink{structModel}{Model}} Dev. Discuss. \mbox{[}preprint\mbox{]}, \href{https://doi.org/10.5194/gmd-2021-15}{\texttt{ https\+://doi.\+org/10.\+5194/gmd-\/2021-\/15}}, in review, 2021.$\ast$ Buttinger-\/\+Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.\+: A fast second-\/order shallow water scheme on two-\/dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-\/108, 2019. 