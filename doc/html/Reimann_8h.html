<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BG_Flood: src/Reimann.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BG_Flood
   &#160;<span id="projectnumber">0.8</span>
   </div>
   <div id="projectbrief">Documentation (Work-in-progress)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Reimann_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Reimann.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="General_8h_source.html">General.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Param_8h_source.html">Param.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Arrays_8h_source.html">Arrays.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Forcing_8h_source.html">Forcing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MemManagement_8h_source.html">MemManagement.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Util__CPU_8h_source.html">Util_CPU.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Reimann.h:</div>
<div class="dyncontent">
<div class="center"><img src="Reimann_8h__incl.png" border="0" usemap="#asrc_2Reimann_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="Reimann_8h__dep__incl.png" border="0" usemap="#asrc_2Reimann_8hdep" alt=""/></div>
</div>
</div>
<p><a href="Reimann_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a705147ee3e9d8b9606e8a4903ea70790"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a705147ee3e9d8b9606e8a4903ea70790"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Reimann_8h.html#a705147ee3e9d8b9606e8a4903ea70790">UpdateButtingerXGPU</a> (<a class="el" href="classParam.html">Param</a> XParam, <a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt; XBlock, <a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt; XEv, <a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt; XGrad, <a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt; XFlux, T *dtmax, T *zb)</td></tr>
<tr class="memdesc:a705147ee3e9d8b9606e8a4903ea70790"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Adaptive" second-order hydrostatic reconstruction. GPU version for t X-axis  <a href="Reimann_8h.html#a705147ee3e9d8b9606e8a4903ea70790">More...</a><br /></td></tr>
<tr class="separator:a705147ee3e9d8b9606e8a4903ea70790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2941a269f627e7a1b2345a7fce7b27"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a2e2941a269f627e7a1b2345a7fce7b27"><td class="memTemplItemLeft" align="right" valign="top">__host__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Reimann_8h.html#a2e2941a269f627e7a1b2345a7fce7b27">UpdateButtingerXCPU</a> (<a class="el" href="classParam.html">Param</a> XParam, <a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt; XBlock, <a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt; XEv, <a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt; XGrad, <a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt; XFlux, T *dtmax, T *zb)</td></tr>
<tr class="memdesc:a2e2941a269f627e7a1b2345a7fce7b27"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Adaptive" second-order hydrostatic reconstruction. CPU version for the X-axis  <a href="Reimann_8h.html#a2e2941a269f627e7a1b2345a7fce7b27">More...</a><br /></td></tr>
<tr class="separator:a2e2941a269f627e7a1b2345a7fce7b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d9e88f683b468fd5ddddf12a293621"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a74d9e88f683b468fd5ddddf12a293621"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Reimann_8h.html#a74d9e88f683b468fd5ddddf12a293621">UpdateButtingerYGPU</a> (<a class="el" href="classParam.html">Param</a> XParam, <a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt; XBlock, <a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt; XEv, <a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt; XGrad, <a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt; XFlux, T *dtmax, T *zb)</td></tr>
<tr class="memdesc:a74d9e88f683b468fd5ddddf12a293621"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Adaptive" second-order hydrostatic reconstruction. GPU version for the Y-axis  <a href="Reimann_8h.html#a74d9e88f683b468fd5ddddf12a293621">More...</a><br /></td></tr>
<tr class="separator:a74d9e88f683b468fd5ddddf12a293621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91240b6e5cc2a5a99990a4ec6dba80a9"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a91240b6e5cc2a5a99990a4ec6dba80a9"><td class="memTemplItemLeft" align="right" valign="top">__host__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Reimann_8h.html#a91240b6e5cc2a5a99990a4ec6dba80a9">UpdateButtingerYCPU</a> (<a class="el" href="classParam.html">Param</a> XParam, <a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt; XBlock, <a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt; XEv, <a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt; XGrad, <a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt; XFlux, T *dtmax, T *zb)</td></tr>
<tr class="memdesc:a91240b6e5cc2a5a99990a4ec6dba80a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Adaptive" second-order hydrostatic reconstruction. CPU version for the Y-axis  <a href="Reimann_8h.html#a91240b6e5cc2a5a99990a4ec6dba80a9">More...</a><br /></td></tr>
<tr class="separator:a91240b6e5cc2a5a99990a4ec6dba80a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a470a128c79ccbb65a5ce45ccd9d3dcd2"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a470a128c79ccbb65a5ce45ccd9d3dcd2"><td class="memTemplItemLeft" align="right" valign="top">__host__ __device__ T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Reimann_8h.html#a470a128c79ccbb65a5ce45ccd9d3dcd2">hllc</a> (T g, T delta, T epsi, T CFL, T cm, T fm, T hm, T hp, T um, T up, T &amp;fh, T &amp;fq)</td></tr>
<tr class="memdesc:a470a128c79ccbb65a5ce45ccd9d3dcd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the Harten-Lax-van Leer-contact (HLLC) flux.  <a href="Reimann_8h.html#a470a128c79ccbb65a5ce45ccd9d3dcd2">More...</a><br /></td></tr>
<tr class="separator:a470a128c79ccbb65a5ce45ccd9d3dcd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a470a128c79ccbb65a5ce45ccd9d3dcd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a470a128c79ccbb65a5ce45ccd9d3dcd2">&#9670;&nbsp;</a></span>hllc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__host__ __device__ T hllc </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>epsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>CFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>hm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>hp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>um</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>fq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the Harten-Lax-van Leer-contact (HLLC) flux. </p>
<h2><a class="anchor" id="autotoc_md178"></a>
Description</h2>
<p>This an implementation of the HLLC solver.</p>
<h2><a class="anchor" id="autotoc_md179"></a>
Where does this come from:</h2>
<p>This scheme was adapted/modified from the Basilisk source code. <a href="http://basilisk.fr/src/riemann.h">http://basilisk.fr/src/riemann.h</a></p>
<p>Reference: (Basilisk reference the scheme from Kurganov reference below) Kurganov, A., &amp; Levy, D. (2002). Central-upwind schemes for the Saint-Venant system. Mathematical Modelling and Numerical Analysis, 36(3), 397-425. </p>

</div>
</div>
<a id="a2e2941a269f627e7a1b2345a7fce7b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2941a269f627e7a1b2345a7fce7b27">&#9670;&nbsp;</a></span>UpdateButtingerXCPU()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__host__ void UpdateButtingerXCPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParam.html">Param</a>&#160;</td>
          <td class="paramname"><em>XParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XGrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>dtmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>zb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Adaptive" second-order hydrostatic reconstruction. CPU version for the X-axis </p>
<h2><a class="anchor" id="autotoc_md172"></a>
Description</h2>
<p>This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-balanced meaning that it conserve the "lake-at-rest" states.</p>
<p>For optimising the code on CPU and GPU there are 4 versions of this function: X or Y and CPU or GPU</p>
<h2><a class="anchor" id="autotoc_md173"></a>
Where does this come from:</h2>
<p>This scheme was adapted/modified from the Basilisk / B-Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction <a href="http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h">http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h</a></p>
<p>Reference: Kirstetter, G., Delestre, O., Lagree, P.-Y., Popinet, S., and Josserand, C.: B-flood 1.0: an open-source Saint-Venant model for flash flood simulation using adaptive refinement, Geosci. <a class="el" href="structModel.html">Model</a> Dev. Discuss. [preprint], <a href="https://doi.org/10.5194/gmd-2021-15">https://doi.org/10.5194/gmd-2021-15</a>, in review, 2021.* Buttinger-Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.: A fast second-order shallow water scheme on two-dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-108, 2019. </p>

</div>
</div>
<a id="a705147ee3e9d8b9606e8a4903ea70790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705147ee3e9d8b9606e8a4903ea70790">&#9670;&nbsp;</a></span>UpdateButtingerXGPU()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__global__ void UpdateButtingerXGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParam.html">Param</a>&#160;</td>
          <td class="paramname"><em>XParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XGrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>dtmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>zb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Adaptive" second-order hydrostatic reconstruction. GPU version for t X-axis </p>
<h2><a class="anchor" id="autotoc_md170"></a>
Description</h2>
<p>This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-balanced meaning that it conserve the "lake-at-rest" states.</p>
<p>For optimising the code on CPU and GPU there are 4 versions of this function: X or Y and CPU or GPU</p>
<h2><a class="anchor" id="autotoc_md171"></a>
Where does this come from:</h2>
<p>This scheme was adapted/modified from the Basilisk / B-Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction <a href="http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h">http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h</a></p>
<p>Reference: Kirstetter, G., Delestre, O., Lagree, P.-Y., Popinet, S., and Josserand, C.: B-flood 1.0: an open-source Saint-Venant model for flash flood simulation using adaptive refinement, Geosci. <a class="el" href="structModel.html">Model</a> Dev. Discuss. [preprint], <a href="https://doi.org/10.5194/gmd-2021-15">https://doi.org/10.5194/gmd-2021-15</a>, in review, 2021.* Buttinger-Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.: A fast second-order shallow water scheme on two-dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-108, 2019. </p>

</div>
</div>
<a id="a91240b6e5cc2a5a99990a4ec6dba80a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91240b6e5cc2a5a99990a4ec6dba80a9">&#9670;&nbsp;</a></span>UpdateButtingerYCPU()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__host__ void UpdateButtingerYCPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParam.html">Param</a>&#160;</td>
          <td class="paramname"><em>XParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XGrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>dtmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>zb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Adaptive" second-order hydrostatic reconstruction. CPU version for the Y-axis </p>
<h2><a class="anchor" id="autotoc_md176"></a>
Description</h2>
<p>This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-balanced meaning that it conserve the "lake-at-rest" states.</p>
<p>For optimising the code on CPU and GPU there are 4 versions of this function: X or Y and CPU or GPU</p>
<h2><a class="anchor" id="autotoc_md177"></a>
Where does this come from:</h2>
<p>This scheme was adapted/modified from the Basilisk / B-Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction <a href="http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h">http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h</a></p>
<p>Reference: Kirstetter, G., Delestre, O., Lagree, P.-Y., Popinet, S., and Josserand, C.: B-flood 1.0: an open-source Saint-Venant model for flash flood simulation using adaptive refinement, Geosci. <a class="el" href="structModel.html">Model</a> Dev. Discuss. [preprint], <a href="https://doi.org/10.5194/gmd-2021-15">https://doi.org/10.5194/gmd-2021-15</a>, in review, 2021.* Buttinger-Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.: A fast second-order shallow water scheme on two-dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-108, 2019. </p>

</div>
</div>
<a id="a74d9e88f683b468fd5ddddf12a293621"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d9e88f683b468fd5ddddf12a293621">&#9670;&nbsp;</a></span>UpdateButtingerYGPU()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__global__ void UpdateButtingerYGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParam.html">Param</a>&#160;</td>
          <td class="paramname"><em>XParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlockP.html">BlockP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XBlock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEvolvingP.html">EvolvingP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGradientsP.html">GradientsP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XGrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFluxP.html">FluxP</a>&lt; T &gt;&#160;</td>
          <td class="paramname"><em>XFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>dtmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>zb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Adaptive" second-order hydrostatic reconstruction. GPU version for the Y-axis </p>
<h2><a class="anchor" id="autotoc_md174"></a>
Description</h2>
<p>This function computes the flux term at the cell interface using the hydrostatic reconstruction from Buttinger et al (2019). This reconstruction is safe for steep slope with thin water depth and is well-balanced meaning that it conserve the "lake-at-rest" states.</p>
<p>For optimising the code on CPU and GPU there are 4 versions of this function: X or Y and CPU or GPU</p>
<h2><a class="anchor" id="autotoc_md175"></a>
Where does this come from:</h2>
<p>This scheme was adapted/modified from the Basilisk / B-Flood source code. I (CypB) changed the zr and zl term back to the Audusse type reconstruction <a href="http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h">http://basilisk.fr/sandbox/b-flood/saint-venant-topo.h</a></p>
<p>Reference: Kirstetter, G., Delestre, O., Lagree, P.-Y., Popinet, S., and Josserand, C.: B-flood 1.0: an open-source Saint-Venant model for flash flood simulation using adaptive refinement, Geosci. <a class="el" href="structModel.html">Model</a> Dev. Discuss. [preprint], <a href="https://doi.org/10.5194/gmd-2021-15">https://doi.org/10.5194/gmd-2021-15</a>, in review, 2021.* Buttinger-Kreuzhuber, A., Horvath, Z., Noelle, S., Bloschl, G., and Waser, J.: A fast second-order shallow water scheme on two-dimensional structured grids over abrupt topography, Advances in water resources, 127, 89-108, 2019. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="Reimann_8h.html">Reimann.h</a></li>
    <li class="footer">Generated on Tue Feb 28 2023 12:43:23 for BG_Flood by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
