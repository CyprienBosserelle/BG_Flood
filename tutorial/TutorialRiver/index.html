
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for BG_Flood, a C++ library for flood fill algorithms.">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/tutorial/TutorialRiver/">
      
      
        <link rel="prev" href="../../Tutorial_intro/">
      
      
        <link rel="next" href="../TutorialJetJulia/">
      
      
      <link rel="icon" href="../../logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Coastal fluvial flooding - BG_Flood Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#river-flooding-tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BG_Flood Documentation" class="md-header__button md-logo" aria-label="BG_Flood Documentation" data-md-component="logo">
      
  <img src="../../Logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BG_Flood Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Coastal fluvial flooding
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CyprienBosserelle/BG_Flood" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    BG_Flood on GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BG_Flood Documentation" class="md-nav__button md-logo" aria-label="BG_Flood Documentation" data-md-component="logo">
      
  <img src="../../Logo_white.png" alt="logo">

    </a>
    BG_Flood Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CyprienBosserelle/BG_Flood" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    BG_Flood on GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TMP Examples of Mkdocs material
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ParametersList-py/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameters list
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manual
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tutorial_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Coastal fluvial flooding
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TutorialJetJulia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jet and Julia
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Gaussian_Wave_Julia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian wave
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transpacific_tsunami/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transpacific tsunami
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TutorialMonaiJulia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monai and Julia
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/RainLoss_ILCL-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ground infiltration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/NewGradient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New Gradient Method
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/Wetdryfix-Conservelevation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wet-dry fix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../References/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Code sources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Code sources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Links
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/annotated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/hierarchy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hierarchy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/class_members/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Members
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/class_member_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/class_member_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/class_member_typedefs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Typedefs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/class_member_enums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Enumerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Namespaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespace_members/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Members
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespace_member_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespace_member_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespace_member_typedefs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Typedefs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/namespace_member_enums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Member Enumerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/macros/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Macros
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../BGFlood/files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div><h1 id="river-flooding-tutorial">River flooding tutorial</h1>
<p>The objectif of this tutorial is to explain how to use the code BG_Flood to model river flooding.
As the code allows rain on grid, we will look at pluvial and fluvial flooding.</p>
<p>This testcase aims to broadly reproduce the flooding event that occured from the 16 to the 18 of July 2021 (a 1 in 50 year flood event). 
During this event, the Buller river, passing through the town of Westport, on the West Coast of the South Island of Aotearoa New Zealand, get out of its primary bed and flooded the Westport area.</p>
<div class="admonition info">
<p class="admonition-title">Prerequisite</p>
<p>Before begining this tutoral, the user is expected to have downloaded the windows executable (<a href="https://github.com/CyprienBosserelle/BG_Flood/releases/latest">last release</a> on github) or compiled the sources (version &gt; 0.8) of the BG_flood code on linux.</p>
</div>
<p>During this tutorial, we will build, step by step, a test case</p>
<h1 id="param-file">Param file</h1>
<p>The interface with BG_flood software is done using only a text file: <code>BG_param.txt</code>
(This is the name of the input parameter file by defauls, an other name can be use as first variable when lauching BG_Flood.)</p>
<p>This file consists in a list of key words and inputs, separated by a "=" sign. 
For a full list of the available key words and a further description of this file, please refer to the [parameter list]{../ParametersList-py.md} and the [manual]{../Manual.md}.</p>
<h1 id="preparation-of-the-topographybathymetry-dem-digital-elevation-model">Preparation of the topography/bathymetry (DEM: Digital Elevation Model)</h1>
<p>The DEM, topography or bathymetry file is the only necessary file to be added to BG_param file to run the model.
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>DEM = Wesport_DEM_8m.nc?z;
</span></code></pre></div>
<p><img alt="bathy" src="../../figure/Westport_topo.png"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different formats can be used for this file ( ASCII: .asc or NetCDF .nc principally).
As Netcdf files can contain different variables, the "?" follows by the name of the variable is needed.</p>
</div>
<p>Without further information, the code will run will default values for physical parameters and initialisation, Neumann boundaries and no external forcing:</p>
<p><img alt="shell" src="../../figure/Shell_output.png"></p>
<p>A result files: <code>output.nc</code> is created (here opened with the [PyNcView]{https://pyncview.software.informer.com/}) </p>
<p><img alt="outputs" src="../../figure/outputs.png"></p>
<p>It contains 2D spatial fields saved regularly in time.
It details the blocs information:</p>
<ul>
<li><code>blockid</code>: block index</li>
<li><code>blocklevel</code>: level of refinement for each block</li>
<li><code>blockstatus</code>: Is the block active ?</li>
<li><code>blockwidth</code>: number of cells in x or y direction in the block (not considering halo cells for computational purpose only)</li>
<li><code>blockxo</code>/<code>blockyo</code>: coordinate of the bottom left corner of he block</li>
</ul>
<p>the time 1D variables or coordinates:</p>
<ul>
<li><code>time</code>: time vector in second or real time</li>
<li><code>xx</code>/<code>yy</code> axis: spacial coordinate in m (by default)</li>
</ul>
<p>and the by default outputs:</p>
<ul>
<li><code>h</code> : the water depth in m</li>
<li><code>u</code> : the veloctity vector component in the x direction</li>
<li><code>v</code>: the velocity vector component in the y direction</li>
<li><code>zb</code>: the bottom/ground elevation (m from vertical projection reference)</li>
<li><code>zs</code>: the surface water elevation (m from vertical projection reference)</li>
</ul>
<p>(see manual for further description of the variables).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In BG_Flood, the memory is organised in blocked for an optimal parallelisation on GPU. All the cells on a block will share some status and parameter such as the level of refinement (or cell size) and the active status.</p>
</div>
<p>A log file: <code>BG_log.txt</code> (very similaire to the shell outputs) is also created to keep the terminal output information:</p>
<p><img alt="logfile" src="../../figure/log_file.png"></p>
<h1 id="basic-fluvial-flooding-set-up">Basic fluvial flooding set-up</h1>
<h2 id="river-discharge">River discharge</h2>
<p>The river are (at this stage) forced by a vertical discharge on a user defined rectagular area:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>river = river_discharge_TeKuha2.txt,1490249,1490427,5367640,5367805;
</span></code></pre></div>
where the four final numbers are: <span class="arithmatex">\(x_1\)</span>, <span class="arithmatex">\(x_2\)</span>, <span class="arithmatex">\(y_1\)</span>, <span class="arithmatex">\(y_2\)</span>, to define the area for the vertical discharge and a text file containing the time-serie of the discharge (first column: time (<span class="arithmatex">\(s\)</span>) from reference time, second column: river discharge in <span class="arithmatex">\(m^3s^{-1}\)</span>).
<p><img alt="riverfile" src="../../figure/river_discharge.png"></p>
<p>This file has been generated from an observed hydrograph, with data saved every <span class="arithmatex">\(5\)</span>min, in second from the begining of the simulation (or event):</p>
<p><img alt="riverF" src="../../figure/TE_Kuha_hydrograph.png"></p>
<p>For each new river, just add the a similar river input line in the parameter file.</p>
<h2 id="timekeeping-parameters">Timekeeping parameters</h2>
<p>In this code, the time is defined in second, relative to some reference or the start of the simulation by default.</p>
<p>The end of the simulation is prescribed in second as :
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>endtime = 21600;
</span></code></pre></div>
<p>The time steps can't be defined by the used, it will be automatically computed as the more restrictive one in the domain by the solver, using the prescribe CFL (Current Friedrich Limiter) value, <span class="arithmatex">\(CFL=0.5000\)</span> by default.</p>
<p>The simulation begin, by default at <span class="arithmatex">\(t=0(s)\)</span>, but this can modify using "totaltime": 
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>totaltime = 3600;
</span></code></pre></div>
to begin one hour after the reference time (used in the forcings for example).
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code was initially designed to consider time only through duration in second. We can now use dates to defined time in the forcings and the param file, including a time reference. </p>
</div>
<h2 id="outputs">Outputs</h2>
<p>There is two types of outputs:</p>
<ul>
<li>map outputs of 2D variables regularly through time</li>
<li>time-serie (TS) output of basic values, at a chosen point position, at each time step.</li>
</ul>
<h3 id="map-outputs">Map outputs</h3>
<p>By default, there is only a map output at the begining and end of the simulation.</p>
<p>The map output can be modify by:</p>
<ul>
<li>defining a timestep (in s) for these outputs:
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>outputtimestep = 3600.0;
</span></code></pre></div></li>
<li>changing the set of variables in the output file (from the list given in the manual)
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>outvars = zs,h,u,v,zb,hmax,Umax,hUmax,twet;
</span></code></pre></div>
The "max" variables will be the maximum value during the whole simulation. To reset it between the outputs, see the resetmax variable.
There is also special variables for risk assesment after inundation (Umax, hmax, hUmax, twet)</li>
<li>changing the name of the output file:
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>outfile = Results_tuto_basicRun.nc;
</span></code></pre></div></li>
<li>saving the output as float (variables are saved as short integer by default.):
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>smallnc = 0;
</span></code></pre></div></li>
</ul>
<h3 id="time-serie-outputs">Time-Serie outputs</h3>
<p>For each TS output needed, a line with the destination file and the postition is needed:</p>
<p></p><div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>TSnodesout=Offshore.txt,1482120,53814890;
</span></code></pre></div>
corresponding to <code>TSnodesout=filename.txt,x_p,y_p;</code>
The file contains 5 colums <span class="arithmatex">\((t, zs, h, u,v)\)</span> with the value at the nearest grid point (to the position defined by the user).
<h2 id="resolution">Resolution</h2>
<p>For a first test, we will modify the resolution and set it to 40m to decrease the computational time:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>dx=40;
</span></code></pre></div>
<h2 id="basic-fluvial-innundation-results">Basic fluvial innundation results</h2>
<p>This the shell output:
<img alt="shell2" src="../../figure/Shell_output2.png">
It shows that 1 river has been added to the model, and also the time progression with 5 map outputs (in addition to the initial time step).</p>
<p>In the outputs, we get the different fields requested, for 6 different times.
<img alt="output2" src="../../figure/outputs_v2.png"></p>
<p>The Time-Serie output is:
<img alt="TS2" src="../../figure/offshore.png"></p>
<h1 id="completing-the-set-up">Completing the set-up</h1>
<h2 id="adding-boundary-conditions">Adding boundary conditions</h2>
<p>Boundaries' conditions are refered by their position, using 'top/bottom/right/left' keywords. They are associated to a boundary type ( 0:wall; 1: Neumann (Default); 2:Dirichlet (zs); 3: abs1d) and possibly a file containing a time serie. In this case, the file name is placed before the type, coma-separated. </p>
<p>In this case, we will use tide boundaries at when at least a part of the boundary is open on the sea, i.e. for the top, left and right boundaries.
At the bottom, we will conserve the default value: 1.
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>left = tide_westport.txt,2; 
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>right = tide_westport.txt,2; 
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>top = tide_westport.txt,2; 
</span></code></pre></div>
<p>In this case, as the boundaries are relatively small compared to the time wave length, we will used the same value along all the boundaries. We will then have only two columns in the file: Time and one elevation.
tide_file
``` txt "tide_westport.txt"
0.000000    0.714714 
600.000000  0.794714 
1200.000000     0.864714 
1800.000000     0.934714 
2400.000000     0.994714 
3000.000000     1.054714 
3600.000000     1.104714 
4200.000000     1.144714 
4800.000000     1.174714 
5400.000000     1.194714 
6000.000000     1.214714 
6600.000000     1.214714 
7200.000000     1.214714 
7800.000000     1.204714 
8400.000000     1.184714 
          ...
336600.000000   -0.635286 
337200.000000   -0.705286 
337800.000000   -0.765286 
338400.000000   -0.825286 
339000.000000   -0.875286 
339600.000000   -0.915286 
340200.000000   -0.955286 </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>They correspond to a classic time Serie observed offshore of the river mouth.
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>![Tide](../figure/tide_westport.png)
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>!!! note 
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    If more values are added to the file (more columns), they will be regularly spread along the boundary and the forcing will be linearly interpolated between these values. 
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>## Bottom friction
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>Different models from bottom friction are available.
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>By default, the model used is -1 corresponding to a Manning model.
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>Here, we will use the model 1 corresponding to a roughness length (see manual for more information on the Bottom friction models).
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>The associated field (ASC or netCDF) or value must be enter with the key word
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>``` txt
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>frictionmodel=1;
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>cf=z0_100423_rec3.asc; #cf=0.01;  #If using a uniform value
</span></code></pre></div>
<p><img alt="Friction" src="../../figure/Bottom_friction_zo.png"></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The model allows a roughness heigh or manning number map smaller than the computational domain and will extrapolate outside of the map.</p>
</div>
<h2 id="initialisation">Initialisation</h2>
<p>By default, the model is initialised by a plane water surface located at <span class="arithmatex">\(z=0.0\)</span>.</p>
<p>This water level can be modify, depending of the local mean sea level and the vertical projection used to create the DEM, using:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>zsinit=-1.39; #in metre
</span></code></pre></div>
The model can also be initialised using a restart/hot start.
A file containing a least the files zb, h or zs, u and v must be provided, with the steps (and no the time value) to use for the restart.
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>hotstartfile = output_4.nc;
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>hotstep=5;
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>the code can be restarted only from an uniform grid (and not from results with multi-level of resolutions).</p>
</div>
<h2 id="model-controls">Model controls</h2>
<p>Some variables can be used to adjust the model (see Manual for more details):</p>
<ul>
<li>run on CPU (or choose a GPU to run on):
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>gpudevice=0;
</span></code></pre></div>
By default, the code will detect if there is a suitable GPU on the machine.</li>
<li>Double precision instead of a float precision during the computation:
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>doubleprecision = 1;
</span></code></pre></div></li>
<li>Minmod limiter parameter (to tune momentum dissipation <span class="arithmatex">\(\in [1,2]\)</span>)
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>theta=1.3; #default value=1.3
</span></code></pre></div></li>
<li>Minimum heigh to concidere a cell wet (m)
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>eps = 0.00010000; #default=0.0001
</span></code></pre></div></li>
</ul>
<h1 id="adding-the-rain">... Adding the rain</h1>
<p>The model allows rain on grid forcing to model pluvial inundations.</p>
<h2 id="rain-forcing">Rain forcing</h2>
<p>A rain intensity in <span class="arithmatex">\(mm.h^{-1}\)</span>, time and space varying can be forced in the model.</p>
<p>The rain can be forced with a time serie (with uniform values on the domain) or a netCDF file if a spacial file is available:</p>
<ul>
<li>Time serie forcing:
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>rainfall=rain_westport.txt
</span></code></pre></div></li>
<li>Spacial file forcing:
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>rainfile=VCSN_buller_202107_dailynzcsmcov_disaggdaily_500m_nztm_clipped.nc?depth;
</span></code></pre></div>
Here, we will use a time serie:
<img alt="RainTS" src="../../figure/rain_westport.png"></li>
</ul>
<p>If the data is given in "rain height", a post-processing to turn it in rain intensity will be needed (at least at this stage of development).</p>
<p>Using the rain on grid forcing will activate all the cells of the domain and will increase the computational time of the simulation. 
Part of the domain can be "de-activate" (the blocs memory will not be allocated for this area) using different methods:</p>
<ul>
<li>using the <code>x0</code> / <code>xmax</code> / <code>y0</code> / <code>ymax</code> keywords to restrain the extend of the computational domain (but still rectangular)
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>x0=1475000; #m
</span></code></pre></div></li>
<li>a manual mask with values 999 in the bathymetry will be read by the code as "non-active" area</li>
<li>masking all the bloc with all cells having an elevation superior to some value:
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>mask=250; #m
</span></code></pre></div></li>
<li>using a shape file to define a "area of interest":
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>AOI=Domain_buffered-sea2.gmt;
</span></code></pre></div></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Method advised</p>
<p>The last method, consisting in using a contour to identify the area we want to include, is advised as the method allows for example to select a catchment, or any complex contour shape. The expected shape is a *.gmt file that can be generated from a contour using <a href="https://www.generic-mapping-tools.org/">GMT</a> tools or directly as a column of x,y points looped (first point = last point).</p>
</div>
<h1 id="refining-the-grid-in-area-of-interest">Refining the grid in area of interest</h1>
<p>The code is based on a Block-uniform quadtree mesh. Each block, actually a 16 by 16 cells, is one unit of computation in the GPU.
These blocks can have different resolutions (but resolution does not change during the computation at this stage).</p>
<p>The initial resolution of the grid is the resolution of the bathymetry/topographic data. To refine or coarsen the grid, you can weather use the "dx" key word and choose a new resolution for the whole domain; wether use the levels of resolution. The reference level, correponding to the bathymetry resolution will be the level 0. Levels of resolution are then defined in relation to the reference levels using positive integers to increase the resolution or refine and negative integer to coarsen the grid by a multiple of two. For a given level  <span class="arithmatex">\(n\)</span> , the resolution  <span class="arithmatex">\(dx_n\)</span> will be:
$$
dx_n=\frac{dx_0}{2^n}
$$</p>
<p>with  <span class="arithmatex">\(dx_0\)</span> the resolution at level 0. </p>
<p>When refinning using the level implementation, different key words are expected:</p>
<ul>
<li><code>Initlevel</code>: level used to create the first mesh created by the code in the mesh refinement process</li>
<li><code>Maxlevel</code>: maximim level of refinement (over-ruling other commands)</li>
<li><code>Minlevel</code>: minimum level of refinement (over-ruling other commands)</li>
</ul>
<p>The grid can also be unregular with an adaptition of the grid to the model (variables at initialisation step or user-defined refinement map). In this case, the cells will be devided in 4 cells for refinement, or 4 cells merged in one for coarsening. The code will ensure a progressive change of resolution (no cell should have a neighbour with more than 1 level of resolution of difference.)</p>
<p>The different methods of refinement available in the code are called using the key word "Adaptation". The refinement can be based on a classical input variable or a variable calculated during the initialisation:</p>
<ul>
<li><code>Threshold</code>: impose a threshold for a different level of resolution</li>
<li><code>Inrange</code>: impose a range for a different level of resolutuion or it can be defined using a map of target levels for refinement:</li>
<li><code>Targetlevel</code>: the levels of resolution will be targeted but will be overruled by the maxlevel, minlevel entrance.</li>
</ul>
<p>To refine the grid for this case, we will use the <em>former coarse simulation</em> and create a map for values where hmax is strictly positive (and/or <span class="arithmatex">\(umax\)</span>,<span class="arithmatex">\(vmax\)</span> different from zero), after removing the sea area. </p>
<p>Here, the bathymetry map resolution is a 10m resolution (<span class="arithmatex">\(dx=10m\)</span>). We will impose:</p>
<ul>
<li>a level -3 resolution ( <span class="arithmatex">\(dx_{-3}=80m\)</span>) in the background domain, </li>
<li>a level 1 resolution ( <span class="arithmatex">\(dx_1=5m\)</span>) in the flooded area</li>
<li>a level 2 resolution ( <span class="arithmatex">\(dx_2=2.5m\)</span>)  in the main river bed area. </li>
</ul>
<figure>
  <img alt="coarseRun" src="../../figure/coarse.png" width="400">
<br>
<figcaption>Maximum water depth obtained using a coarse uniform mesh, used to inform refinement.</figcaption>
</figure>
<figure>
  <img alt="refine" src="../../figure/refine.png" width="400">
<br>
<figcaption>Refinement map obtained based on coarse model, used to enforce refinement.</figcaption>
</figure>
<figure>
  <img alt="meshrefine" src="../../figure/test_1.png" width="400">
<br>
<figcaption>Mesh refinement generated by the code.</figcaption>
</figure>
<p>To use it, the following options need to be added to the param file:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>initlevel = -3 ;
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>maxlevel = 2 ;
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>minlevel = -3 ;
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>Adaptation = Targetlevel,refin_mask.nc?z ;
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to optimise the results when using a refined grid, different bathymetry files can be provided. A higher resolution one with smaller extend can be provided as a second DEM and will be use by the code when refining the grid (the code will use the last entered, having the info available):
 </p><div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>DEM = Wesport_DEM_8m.nc?z;
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>DEM = Wesport_DEM_2m_zoomed.nc?z;
</span></code></pre></div>
 Similarly, different input files can be used for the roughness coefficient.
</div>
<div class="admonition note">
<p class="admonition-title">Note again ...</p>
<p>The code also allows for zone outputs: the output of different zones defined by the user (<code>output-file-name,x1,x2,y1,y2</code>):
 </p><div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>outzone=zoomed.nc,5.3,5.4,0.5,0.8;
</span></code></pre></div>
</div>
<h2 id="results">Results:</h2>
<p>This is the logfile:
</p><div class="language-text highlight"><span class="filename">BG_log.txt</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>#################################
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>BG_Flood v0.8
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>#################################
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>#################################
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>#
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>model started at 21-02-2023 21:22:53
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>Reading parameter file: BG_param.txt ...
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>Reading bathymetry grid data...
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>Reading forcing metadata. file: Westport_DEM_8m.nc extension: nc
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>Forcing grid info: nx=2604 ny=3137 dx=8.000000 grdalpha=0.000000 xo=1474101.125000 xmax=1494925.125000 yo=5364343.000000 ymax=5389431.000000
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>Reading boundary data...
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>Read Roughness map (cf) data...
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>Reading forcing metadata. file: z0_100423_rec3.asc extension: asc
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>For asc of bathy file please specify grdalpha in the BG_param.txt (default 0)
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>Forcing grid info: nx=1724 ny=2420 dx=4.800000 grdalpha=0.000000 xo=1480847.600000 xmax=1489118.000000 yo=5369291.600000 ymax=5380902.800000
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>Read Target level data...
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>Reading forcing metadata. file: refin_mask.nc extension: nc
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>Forcing grid info: nx=624 ny=400 dx=50.000000 grdalpha=0.000000 xo=1469074.407363 xmax=1500224.407363 yo=5364597.770576 ymax=5384547.770576
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>Preparing rivers (1 rivers)
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>Preparing Rain forcing
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a>Adjusted model domain (xo/xmax/yo/ymax): 
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a>    1474097.125000/1495057.125000/5364339.000000/5389459.000000
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a>     Initial resolution (level 2) = 10.000000
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a>There are 1 GPU devices on this machine
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a>Using Device: NVIDIA T500
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a>Initializing mesh
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a>    Initial number of blocks: 20567; Will be allocating 21596 in memory.
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37" href="#__codelineno-26-37"></a>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38" href="#__codelineno-26-38"></a>Initial condition:
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39" href="#__codelineno-26-39"></a>    Warm start
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40" href="#__codelineno-26-40"></a>    Initializing rivers
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41" href="#__codelineno-26-41"></a>Adapting mesh
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42" href="#__codelineno-26-42"></a>     Iteration 1
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43" href="#__codelineno-26-43"></a>        There are 20567 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 4723 blocks to be coarsen (with neighbour); 1675 blocks untouched; 14169 blocks to be freed (1029 are already available) 0 new blocks will be created
</span><span id="__span-26-44"><a id="__codelineno-26-44" name="__codelineno-26-44" href="#__codelineno-26-44"></a>     Iteration 2
</span><span id="__span-26-45"><a id="__codelineno-26-45" name="__codelineno-26-45" href="#__codelineno-26-45"></a>        There are 6398 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 1023 blocks to be coarsen (with neighbour); 2306 blocks untouched; 3069 blocks to be freed (15198 are already available) 0 new blocks will be created
</span><span id="__span-26-46"><a id="__codelineno-26-46" name="__codelineno-26-46" href="#__codelineno-26-46"></a>     Iteration 3
</span><span id="__span-26-47"><a id="__codelineno-26-47" name="__codelineno-26-47" href="#__codelineno-26-47"></a>        There are 3329 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 179 blocks to be coarsen (with neighbour); 2613 blocks untouched; 537 blocks to be freed (18267 are already available) 0 new blocks will be created
</span><span id="__span-26-48"><a id="__codelineno-26-48" name="__codelineno-26-48" href="#__codelineno-26-48"></a>     Iteration 4
</span><span id="__span-26-49"><a id="__codelineno-26-49" name="__codelineno-26-49" href="#__codelineno-26-49"></a>        There are 2792 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 18 blocks to be coarsen (with neighbour); 2720 blocks untouched; 54 blocks to be freed (18804 are already available) 0 new blocks will be created
</span><span id="__span-26-50"><a id="__codelineno-26-50" name="__codelineno-26-50" href="#__codelineno-26-50"></a>     Iteration 5
</span><span id="__span-26-51"><a id="__codelineno-26-51" name="__codelineno-26-51" href="#__codelineno-26-51"></a>        There are 2738 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 1 blocks to be coarsen (with neighbour); 2734 blocks untouched; 3 blocks to be freed (18858 are already available) 0 new blocks will be created
</span><span id="__span-26-52"><a id="__codelineno-26-52" name="__codelineno-26-52" href="#__codelineno-26-52"></a>     Iteration 6
</span><span id="__span-26-53"><a id="__codelineno-26-53" name="__codelineno-26-53" href="#__codelineno-26-53"></a>        There are 2735 active blocks (21596 blocks allocated in memory), 0 blocks to be refined, 0 blocks to be coarsen (with neighbour); 2735 blocks untouched; 0 blocks to be freed (18861 are already available) 0 new blocks will be created
</span><span id="__span-26-54"><a id="__codelineno-26-54" name="__codelineno-26-54" href="#__codelineno-26-54"></a>
</span><span id="__span-26-55"><a id="__codelineno-26-55" name="__codelineno-26-55" href="#__codelineno-26-55"></a>Initial condition:
</span><span id="__span-26-56"><a id="__codelineno-26-56" name="__codelineno-26-56" href="#__codelineno-26-56"></a>    Warm start
</span><span id="__span-26-57"><a id="__codelineno-26-57" name="__codelineno-26-57" href="#__codelineno-26-57"></a>    Initializing rivers
</span><span id="__span-26-58"><a id="__codelineno-26-58" name="__codelineno-26-58" href="#__codelineno-26-58"></a>Setting up GPU
</span><span id="__span-26-59"><a id="__codelineno-26-59" name="__codelineno-26-59" href="#__codelineno-26-59"></a>
</span><span id="__span-26-60"><a id="__codelineno-26-60" name="__codelineno-26-60" href="#__codelineno-26-60"></a>Model setup complete
</span><span id="__span-26-61"><a id="__codelineno-26-61" name="__codelineno-26-61" href="#__codelineno-26-61"></a>#################################
</span><span id="__span-26-62"><a id="__codelineno-26-62" name="__codelineno-26-62" href="#__codelineno-26-62"></a>Initialising model main loop
</span><span id="__span-26-63"><a id="__codelineno-26-63" name="__codelineno-26-63" href="#__codelineno-26-63"></a>Create netCDF output file...
</span><span id="__span-26-64"><a id="__codelineno-26-64" name="__codelineno-26-64" href="#__codelineno-26-64"></a>Warning! Output file name already exist   
</span><span id="__span-26-65"><a id="__codelineno-26-65" name="__codelineno-26-65" href="#__codelineno-26-65"></a>New file name: Results_tuto_basicRun_2.nc
</span><span id="__span-26-66"><a id="__codelineno-26-66" name="__codelineno-26-66" href="#__codelineno-26-66"></a>        Completed
</span><span id="__span-26-67"><a id="__codelineno-26-67" name="__codelineno-26-67" href="#__codelineno-26-67"></a>Model Running...
</span><span id="__span-26-68"><a id="__codelineno-26-68" name="__codelineno-26-68" href="#__codelineno-26-68"></a>Output to map. Totaltime = 7200.000000 s; Mean dt = 2.230207e-01 s
</span></code></pre></div>
In the model output, each resolution is store independently. 
When open with pyncview, we can visualise each layer. QGIS can merge all these layer togather or a postratement steps will be needed.
<p><img alt="output_v3" src="../../figure/outputs_v3.png"></p>
<h2 id="ground-infiltration-losses-basic-ilcl-model">Ground infiltration losses (Basic ILCL model)</h2>
<p>An Initial Loss, Continuous Loss model has been implemented in the code (see ILCL page). 
<img alt="ILCL_tuto" src="../../figure/Ex_Merge.png"></p>
<p>To use it, provide maps for the two coefficient as follow:
 <code>txt
initialloss=InitialLoss.asc;
continuousloss=ContinuousLoss.asc;</code> </p>
<h1 id="_1"></h1></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.sections", "toc.integrate", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>